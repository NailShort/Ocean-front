import{aA as k,r as U,c as D,b1 as _,aN as d,k as f,l as y,m as s,d as o,Q as r,F as w,aO as C,aa as F,a8 as c,a_ as B,aK as h,ab as P,ac as N,aW as V,be as z,y as j,b0 as E,t as K,u as L}from"./index.7857a1ea.js";import{Q as M}from"./QSelect.d8d12153.js";import{Q as O}from"./QFile.111ed352.js";import{Q as W}from"./QForm.2549fd3f.js";import{_ as Y}from"./plugin-vue_export-helper.21dcd24c.js";import"./selection.4a3f2feb.js";import"./QItemLabel.e782caa8.js";import"./rtl.b51694b1.js";import"./format.2a3572e1.js";const x=u=>(K("data-v-57d5e4ac"),u=u(),L(),u),G={id:"Admin"},H={class:"content justify-center",align:"center"},J={class:"top col-12 row"},R=x(()=>s("div",{class:"col-8"},[s("h4",{class:"title"},"\u6587\u7AE0\u8A0E\u8AD6\u7BA1\u7406")],-1)),T={class:"new col-4 q-pa-md q-gutter-sm"},X={class:"q-pa-md q-gutter-sm col-12",align:"center"},Z=["fishActive"],ee=x(()=>s("thead",null,[s("tr",{align:"left"},[s("th",null,"\u5716\u7247"),s("th",null,"\u6A19\u984C"),s("th",null,"\u65E5\u671F"),s("th",null,"\u7BA1\u7406")])],-1)),te={class:"img"},le=["src"],ae={class:"name"},se={class:"time"},oe={class:"btn"},ie={class:"text-h6"},ne={__name:"ArticlePage",setup(u){const q=["\u6D77\u6C34\u9B5A\u985E","\u73CA\u745A\u8EDF\u9AD4","\u786C\u9AD4\u8A2D\u5099","\u4E8C\u624B\u5206\u4EAB"],m={required(l){return!!l||"\u6B04\u4F4D\u5FC5\u586B"}},n=k([]),e=k({_id:"",name:"",time:"",description:"",image:void 0,sell:!1,category:"",loading:!1,dialog:!1,idx:-1}),v=new Date,A=`${v.getFullYear()}\u5E74${v.getMonth()+1}\u6708${v.getDate()}\u65E5`,Q=l=>{l===-1?(e._id="",e.name="",e.time=A,e.description="",e.image=void 0,e.sell=!1,e.category="",e.loading=!1,e.idx=-1):(e._id=n[l]._id,e.name=n[l].name,e.time=n[l].time,e.description=n[l].description,e.image=void 0,e.sell=n[l].sell,e.category=n[l].category,e.loading=!1,e.idx=l),e.dialog=!0},$=async()=>{var a,t;e.loading=!0;const l=new FormData;l.append("name",e.name),l.append("time",e.time),l.append("description",e.description),l.append("image",e.image),l.append("sell",e.sell),l.append("category",e.category);try{if(e._id.length===0){const{data:i}=await _.post("/products",l);n.push(i.result),d.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:i}=await _.patch("/products/"+e._id,l);n[e.idx]=i.result,d.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(i){d.fire({icon:"error",title:"\u5931\u6557",text:((t=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:t.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1},S=async l=>{var a,t;try{await _.delete(`/products/${l}`);const i=n.findIndex(g=>g._id===l);n.splice(i,1),d.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"})}catch(i){d.fire({icon:"error",title:"\u5931\u6557",text:((t=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:t.message)||"\u767C\u751F\u932F\u8AA4"})}},b=["\u6240\u6709\u6587\u7AE0","\u6D77\u6C34\u9B5A\u985E","\u73CA\u745A\u8EDF\u9AD4","\u786C\u9AD4\u8A2D\u5099","\u4E8C\u624B\u5206\u4EAB"],p=U(b[0]),I=D(()=>n.filter(l=>p.value===b[0]?l:l.category===p.value));return(async()=>{var l,a;try{const{data:t}=await _.get("/products/all");n.push(...t.result)}catch(t){d.fire({icon:"error",title:"\u5931\u6557",text:((a=(l=t==null?void 0:t.response)==null?void 0:l.data)==null?void 0:a.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(l,a)=>(f(),y("div",G,[s("div",H,[s("div",J,[R,s("div",T,[o(r,{label:"\u65B0\u589E\u5546\u54C1",color:"primary",onClick:a[0]||(a[0]=t=>Q(-1))})])]),s("div",X,[(f(),y(w,null,C(b,(t,i)=>o(r,{outline:"",rounded:"",color:"primary",key:i,label:t,onClick:g=>p.value=t},null,8,["label","onClick"])),64))]),s("table",{fishActive:p.value},[ee,s("tbody",null,[(f(!0),y(w,null,C(F(I),(t,i)=>(f(),y("tr",{key:t._id},[s("td",te,[s("img",{src:t.image,width:100},null,8,le)]),s("td",ae,h(t.name),1),s("td",se,h(t.time),1),s("td",oe,[o(r,{round:"",color:"primary",icon:"edit",onClick:g=>Q(i)},null,8,["onClick"]),o(r,{round:"",color:"red",icon:"delete",onClick:g=>S(t._id)},null,8,["onClick"])])]))),128))])],8,Z),o(B,{modelValue:e.dialog,"onUpdate:modelValue":a[8]||(a[8]=t=>e.dialog=t),persistent:""},{default:c(()=>[o(P,{style:{width:"100%"}},{default:c(()=>[o(W,{onSubmit:$},{default:c(()=>[o(N,null,{default:c(()=>[s("div",ie,h(e._id.length>0?"\u7DE8\u8F2F\u5546\u54C1":"\u65B0\u589E\u5546\u54C1"),1),o(V,{filled:"",modelValue:e.name,"onUpdate:modelValue":a[1]||(a[1]=t=>e.name=t),label:"\u6587\u7AE0",hint:"","lazy-rules":"",rules:[m.required]},null,8,["modelValue","rules"]),o(V,{filled:"",modelValue:e.time,"onUpdate:modelValue":a[2]||(a[2]=t=>e.time=t),label:"\u50F9\u683C","lazy-rules":"",rules:[m.required]},null,8,["modelValue","rules"]),o(V,{filled:"",modelValue:e.description,"onUpdate:modelValue":a[3]||(a[3]=t=>e.description=t),autogrow:"",label:"\u8AAA\u660E",rules:[m.required]},null,8,["modelValue","rules"]),o(M,{filled:"",modelValue:e.category,"onUpdate:modelValue":a[4]||(a[4]=t=>e.category=t),options:q,label:"\u5206\u985E",rules:[m.required]},null,8,["modelValue","rules"]),o(z,{modelValue:e.sell,"onUpdate:modelValue":a[5]||(a[5]=t=>e.sell=t),label:"\u4E0A\u67B6"},null,8,["modelValue"]),o(O,{outlined:"",modelValue:e.image,"onUpdate:modelValue":a[6]||(a[6]=t=>e.image=t)},{prepend:c(()=>[o(j,{name:"attach_file"})]),_:1},8,["modelValue"])]),_:1}),o(E,{align:"center",class:"text-primary"},{default:c(()=>[o(r,{disabled:e.loading,type:"submit",color:"primary",label:"\u9001\u51FA"},null,8,["disabled"]),o(r,{disabled:e.loading,onClick:a[7]||(a[7]=t=>e.dialog=!1),label:"\u53D6\u6D88",color:"primary",flat:"",class:"q-ml-sm"},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]))}};var ye=Y(ne,[["__scopeId","data-v-57d5e4ac"]]);export{ye as default};
