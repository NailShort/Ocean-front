import{v as K,$ as X,ad as Y,a0 as G,ae as H,c as o,at as J,g as $,h as v,y as O,af as Z,R as ee,M as w,r as T,ap as te,ak as le,b2 as ne,b3 as ie,b4 as ae,b5 as ue,b6 as re,b7 as oe,b8 as Q,b9 as ce,ba as se,ao as de}from"./index.7857a1ea.js";import{h as fe}from"./format.2a3572e1.js";const ve={xs:8,sm:10,md:14,lg:20,xl:24};var me=K({name:"QChip",props:{...X,...Y,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:d,emit:h}){const{proxy:{$q:g}}=$(),r=G(e,g),c=H(e,ve),y=o(()=>e.selected===!0||e.icon!==void 0),x=o(()=>e.selected===!0?e.iconSelected||g.iconSet.chip.selected:e.icon),k=o(()=>e.iconRemove||g.iconSet.chip.remove),F=o(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),_=o(()=>{const n=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(n?` text-${n} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(F.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(r.value===!0?" q-chip--dark q-dark":"")}),p=o(()=>{const n=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},q={...n,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||g.lang.label.remove};return{chip:n,remove:q}});function z(n){n.keyCode===13&&V(n)}function V(n){e.disable||(h("update:selected",!e.selected),h("click",n))}function D(n){(n.keyCode===void 0||n.keyCode===13)&&(w(n),e.disable===!1&&(h("update:modelValue",!1),h("remove")))}function u(){const n=[];F.value===!0&&n.push(v("div",{class:"q-focus-helper"})),y.value===!0&&n.push(v(O,{class:"q-chip__icon q-chip__icon--left",name:x.value}));const q=e.label!==void 0?[v("div",{class:"ellipsis"},[e.label])]:void 0;return n.push(v("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},Z(d.default,q))),e.iconRight&&n.push(v(O,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&n.push(v(O,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:k.value,...p.value.remove,onClick:D,onKeyup:D})),n}return()=>{if(e.modelValue===!1)return;const n={class:_.value,style:c.value};return F.value===!0&&Object.assign(n,p.value.chip,{onClick:V,onKeyup:z}),J("div",n,u(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[ee,e.ripple]])}}});function j(e,d,h,g){const r=[];return e.forEach(c=>{g(c)===!0?r.push(c):d.push({failedPropValidation:h,file:c})}),r}function P(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),w(e)}const ge={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},be=["rejected"];function he({editable:e,dnd:d,getFileInput:h,addFilesToQueue:g}){const{props:r,emit:c,proxy:y}=$(),x=T(null),k=o(()=>r.accept!==void 0?r.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),F=o(()=>parseInt(r.maxFiles,10)),_=o(()=>parseInt(r.maxTotalSize,10));function p(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&te(t);else{const b=h();b&&b!==t.target&&b.click(t)}}function z(t){e.value&&t&&g(null,t)}function V(t,b,I,N){let i=Array.from(b||t.target.files);const m=[],C=()=>{m.length>0&&c("rejected",m)};if(r.accept!==void 0&&k.value.indexOf("*/")===-1&&(i=j(i,m,"accept",a=>k.value.some(s=>a.type.toUpperCase().startsWith(s)||a.name.toUpperCase().endsWith(s))),i.length===0))return C();if(r.maxFileSize!==void 0){const a=parseInt(r.maxFileSize,10);if(i=j(i,m,"max-file-size",s=>s.size<=a),i.length===0)return C()}if(r.multiple!==!0&&i.length>0&&(i=[i[0]]),i.forEach(a=>{a.__key=a.webkitRelativePath+a.lastModified+a.name+a.size}),N===!0){const a=I.map(s=>s.__key);i=j(i,m,"duplicate",s=>a.includes(s.__key)===!1)}if(i.length===0)return C();if(r.maxTotalSize!==void 0){let a=N===!0?I.reduce((s,R)=>s+R.size,0):0;if(i=j(i,m,"max-total-size",s=>(a+=s.size,a<=_.value)),i.length===0)return C()}if(typeof r.filter=="function"){const a=r.filter(i);i=j(i,m,"filter",s=>a.includes(s))}if(r.maxFiles!==void 0){let a=N===!0?I.length:0;if(i=j(i,m,"max-files",()=>(a++,a<=F.value)),i.length===0)return C()}if(C(),i.length>0)return i}function D(t){P(t),d.value!==!0&&(d.value=!0)}function u(t){w(t),(t.relatedTarget!==null||le.is.safari!==!0?t.relatedTarget!==x.value:document.elementsFromPoint(t.clientX,t.clientY).includes(x.value)===!1)===!0&&(d.value=!1)}function n(t){P(t);const b=t.dataTransfer.files;b.length>0&&g(null,b),d.value=!1}function q(t){if(d.value===!0)return v("div",{ref:x,class:`q-${t}__dnd absolute-full`,onDragenter:P,onDragover:P,onDragleave:u,onDrop:n})}return Object.assign(y,{pickFiles:p,addFiles:z}),{pickFiles:p,addFiles:z,onDragover:D,onDragleave:u,processFiles:V,getDndNode:q,maxFilesNumber:F,maxTotalSizeNumber:_}}var xe=K({name:"QFile",inheritAttrs:!1,props:{...ne,...ie,...ge,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...ae,...be],setup(e,{slots:d,emit:h,attrs:g}){const{proxy:r}=$(),c=ue(),y=T(null),x=T(!1),k=re(e),{pickFiles:F,onDragover:_,onDragleave:p,processFiles:z,getDndNode:V}=he({editable:c.editable,dnd:x,getFileInput:E,addFilesToQueue:L}),D=oe(e),u=o(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),n=o(()=>Q(u.value)),q=o(()=>u.value.map(l=>l.name).join(", ")),t=o(()=>fe(u.value.reduce((l,f)=>l+f.size,0))),b=o(()=>({totalSize:t.value,filesNumber:u.value.length,maxFiles:e.maxFiles})),I=o(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:k.value,...g,id:c.targetUid.value,disabled:c.editable.value!==!0})),N=o(()=>"q-file q-field--auto-height"+(x.value===!0?" q-file--dnd":"")),i=o(()=>e.multiple===!0&&e.append===!0);function m(l){const f=u.value.slice();f.splice(l,1),a(f)}function C(l){const f=u.value.findIndex(l);f>-1&&m(f)}function a(l){h("update:modelValue",e.multiple===!0?l:l[0])}function s(l){l.keyCode===13&&de(l)}function R(l){(l.keyCode===13||l.keyCode===32)&&F(l)}function E(){return y.value}function L(l,f){const S=z(l,f,u.value,i.value),B=E();B!=null&&(B.value=""),S!==void 0&&((e.multiple===!0?e.modelValue&&S.every(W=>u.value.includes(W)):e.modelValue===S[0])||a(i.value===!0?u.value.concat(S):S))}function A(){return[v("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function M(){if(d.file!==void 0)return u.value.length===0?A():u.value.map((f,S)=>d.file({index:S,file:f,ref:this}));if(d.selected!==void 0)return u.value.length===0?A():d.selected({files:u.value,ref:this});if(e.useChips===!0)return u.value.length===0?A():u.value.map((f,S)=>v(me,{key:"file-"+S,removable:c.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{m(S)}},()=>v("span",{class:"ellipsis",textContent:f.name})));const l=e.displayValue!==void 0?e.displayValue:q.value;return l.length>0?[v("div",{class:e.inputClass,style:e.inputStyle,textContent:l})]:A()}function U(){const l={ref:y,...I.value,...D.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:L};return e.multiple===!0&&(l.multiple=!0),v("input",l)}return Object.assign(c,{fieldClass:N,emitValue:a,hasValue:n,inputRef:y,innerValue:u,floatingLabel:o(()=>n.value===!0||Q(e.displayValue)),computedCounter:o(()=>{if(e.counterLabel!==void 0)return e.counterLabel(b.value);const l=e.maxFiles;return`${u.value.length}${l!==void 0?" / "+l:""} (${t.value})`}),getControlChild:()=>V("file"),getControl:()=>{const l={ref:c.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return c.editable.value===!0&&Object.assign(l,{onDragover:_,onDragleave:p,onKeydown:s,onKeyup:R}),v("div",l,[U()].concat(M()))}}),Object.assign(r,{removeAtIndex:m,removeFile:C,getNativeElement:()=>y.value}),ce(r,"nativeEl",()=>y.value),se(c)}});export{xe as Q,me as a};
