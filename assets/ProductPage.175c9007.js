import{k as _,l as g,m as s,aK as u,t as S,u as k,a5 as T,c as A,aA as y,d as l,Q as d,aa as b,aL as R,a8 as c,b0 as B,F as L,aO as N,b1 as U,aX as q,aM as w,aN as m,ab as K,ac as x,aY as O,y as z,b2 as E,aP as M,aQ as X,b3 as $}from"./index.ea07f8f0.js";import{Q as Y}from"./QFile.cba07b2e.js";import{Q as G}from"./QForm.bf03f46c.js";import{_ as F}from"./plugin-vue_export-helper.21dcd24c.js";import"./format.2a3572e1.js";const H=r=>(S("data-v-5030dc86"),r=r(),k(),r),J=["to"],W={class:"re-user col-3 items-center justify-center"},Z={class:"user-img col-12"},ee=["src"],te={class:"re-name col-12"},se={class:"re-des col-9"},ae=H(()=>s("div",{class:"line"},null,-1)),oe={class:"time"},ie=["src"],le={__name:"ReplyCard",props:{_id:{type:String,default:""},userid:{type:String,default:""},time:{type:Date,default:Date.now},description:{type:String,default:""},image:{type:String,default:""}},setup(r){return(h,v)=>(_(),g("div",{to:"/replys/"+r._id,class:"reply col-12 row items-center justify-center"},[s("div",W,[s("div",Z,[s("img",{src:r.userid.image||`https://source.boringavatars.com/beam/256/${r.userid.name}?colors=000000,F0A818,304878,181848,F0A818`},null,8,ee)]),s("div",te,u(r.userid.name||""),1)]),s("div",se,[ae,s("p",oe,u(new Date(r.time).toLocaleString()),1),s("img",{src:r.image},null,8,ie),s("p",null,u(r.description),1)])],8,J))}};var re=F(le,[["__scopeId","data-v-5030dc86"]]);const f=r=>(S("data-v-c5e737d2"),r=r(),k(),r),ne={id:"product"},de={class:"route col-12 row items-center justify-start"},ce=f(()=>s("span",null,">",-1)),ue=f(()=>s("span",null,">",-1)),pe={class:"contant row warp items-center justify-center"},me={class:"col-12 row items-center justify-center"},_e={class:"img"},ge=["src"],ye={class:"col-12"},fe={class:"title"},he={class:"user row items-center justify-center"},ve={class:"user-img"},be=["src"],we={class:"user-name"},xe={class:"des col-10"},$e={class:"pre"},Se={class:"reply-btn col-10"},ke=f(()=>s("div",{class:"text-h6"},"\u8ACB\u8F38\u5165\u5167\u5BB9",-1)),Fe={class:"top col-12 row items-center justify-end"},Qe={methods:{scrollToTop(){document.body.scrollIntoView({behavior:"smooth"})}}},Ve=Object.assign(Qe,{__name:"ProductPage",setup(r){const h=T(),v=U(),Q=q(),{editLike:V}=h,C=A(()=>o.userid.image||`https://source.boringavatars.com/beam/256/${o.userid.name}?colors=000000,F0A818,304878,181848,F0A818`),p=y([]),t=y({_id:"",name:"",time:"",description:"",image:void 0,loading:!1,dialog:!1,idx:-1}),P=e=>{e===-1?(t._id="",t.description="",t.image=void 0,t.loading=!1,t.idx=-1):(t._id=p[e]._id,t.description=p[e].description,t.image=void 0,t.loading=!1,t.idx=e),t.dialog=!0},j=async()=>{var i,a;t.loading=!0;const e=new FormData;e.append("description",t.description),e.append("image",t.image),e.append("proid",o._id);try{if(t._id.length===0){const{data:n}=await $.post("/replys",e);p.push(n.result),m.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:n}=await $.patch("/replys/"+t._id,e);p[t.idx]=n.result,m.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}t.dialog=!1}catch(n){console.log(n),m.fire({icon:"error",title:"\u5931\u6557",text:((a=(i=n==null?void 0:n.response)==null?void 0:i.data)==null?void 0:a.message)||"\u767C\u751F\u932F\u8AA4"})}t.loading=!1},o=y({_id:"",name:"",time:"",description:"",image:"",sell:!0,category:"",userid:""}),D=async()=>{try{const{data:e}=await w.get("/products/"+v.params.id);o._id=e.result._id,o.name=e.result.name,o.time=e.result.time,o.description=e.result.description,o.image=e.result.image,o.sell=e.result.sell,o.category=e.result.category,o.userid=e.result.userid,document.title="\u8CFC\u7269\u7DB2 | \u5546\u54C1 | "+o.name}catch{m.fire({icon:"error",title:"\u5931\u6557",text:"\u53D6\u5F97\u5546\u54C1\u5931\u6557"}),Q.go(-1)}},I=async()=>{var e,i;try{const{data:a}=await w.get("/replys/"+o._id);console.log(a.result),p.push(...a.result)}catch(a){m.fire({icon:"error",title:"\u5931\u6557",text:((i=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:i.message)||"\u767C\u751F\u932F\u8AA4"})}};return(async()=>(await D(),await I()))(),(e,i)=>(_(),g("div",ne,[s("div",de,[l(d,{to:"/",flat:"",style:{color:"black"},label:"\u9996\u9801"}),ce,l(d,{to:"/article",flat:"",style:{color:"black"},label:"\u6587\u7AE0\u8A0E\u8AD6"}),ue,l(d,{disable:!e.progress,flat:"",style:{color:"gray"},label:o.name},null,8,["disable","label"])]),s("div",pe,[s("div",me,[s("div",_e,[s("img",{src:o.image},null,8,ge)])]),s("div",ye,[s("p",fe,u(o.name),1),s("p",he,[s("span",ve,[s("img",{src:b(C)},null,8,be)]),s("span",we,u(o.userid.name),1),R(" "+u(o.time)+" ",1),l(d,{class:"like",icon:"favorite_border",label:"Like",onClick:i[0]||(i[0]=a=>b(V)({_id:e._id,quantity:1}))})])]),s("div",xe,[s("p",$e,u(o.description),1)]),s("div",Se,[l(d,{label:"\u56DE\u8986\u6587\u7AE0",color:"primary",onClick:i[1]||(i[1]=a=>P(-1))}),l(B,{modelValue:t.dialog,"onUpdate:modelValue":i[5]||(i[5]=a=>t.dialog=a),persistent:""},{default:c(()=>[l(K,{style:{width:"100%"}},{default:c(()=>[l(G,{onSubmit:j},{default:c(()=>[l(x,null,{default:c(()=>[ke]),_:1}),l(x,{class:"q-pt-none"},{default:c(()=>[l(O,{class:"col-12",style:{padding:"10px"},modelValue:t.description,"onUpdate:modelValue":i[2]||(i[2]=a=>t.description=a),filled:"",clearable:"",type:"textarea",color:"red-12",label:"\u5167\u6587",hint:"\u8F38\u5165\u5167\u6587","shadow-text":e.textareaShadowText,onKeydown:e.processTextareaFill,onFocus:e.processTextareaFill},null,8,["modelValue","shadow-text","onKeydown","onFocus"]),l(Y,{outlined:"",modelValue:t.image,"onUpdate:modelValue":i[3]||(i[3]=a=>t.image=a),class:"col-12",style:{padding:"10px","margin-top":"10px"}},{prepend:c(()=>[l(z,{name:"attach_file"})]),_:1},8,["modelValue"])]),_:1}),l(E,{align:"right",class:"text-primary"},{default:c(()=>[l(d,{disabled:t.loading,type:"submit",color:"primary",label:"\u9001\u51FA"},null,8,["disabled"]),l(d,{disabled:t.loading,onClick:i[4]||(i[4]=a=>t.dialog=!1),label:"\u53D6\u6D88",color:"primary",flat:"",class:"q-ml-sm"},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),(_(!0),g(L,null,N(p,a=>(_(),g("div",{class:"col-12 row justify-center items-center",key:a._id},[l(re,M(X(a)),null,16)]))),128)),s("div",Fe,[l(d,{ref:"myButton",onClick:e.scrollToTop,flat:"",style:{color:"rgb(15,85,165)"},icon:"navigation"},null,8,["onClick"])])]))}});var Te=F(Ve,[["__scopeId","data-v-c5e737d2"]]);export{Te as default};
